<!DOCTYPE html>
<html lang="ja">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
 <title>神輿たらん　歌まとめ</title>
 <link rel="stylesheet" href="/style.css">
</head>

<style>
 #users {
  height:75vh;
  overflow-y: scroll;
 }
</style>

<body>
 <div id="body">
  <div class="fav">
   <h1 id="strcolor1">神輿たらん　歌まとめ</h1>
　 <span class="strcolor2"><input type="checkbox" onchange="favdisplay()" class="checkboxA" id="checkboxA"> お気に入り</span>
   <button class="remove" id="remove" onclick="favremove()">お気に入り削除</button>　　
   <span class="strcolor2"><input type="checkbox" onchange="moviedisplay()" class="checkboxB" id="checkboxB"> 動画のみ</span></br>


   <div style="display: inline-block; _display: inline;" id="category-title"><span class="strcolor2">　歌手名</span>
    <select name="category" id="category" onchange="changeCategory()">
      <option value="non">選択なし</option>
      <option value="Whiteberry">Whiteberry</option>
    </select>
   </div>

   <div style="display: inline-block; _display: inline;" id="category-second-title"><span class="strcolor2">&nbsp;曲名</span>
     <select  name="category-second" id="category-second" onchange="changeCategory2()"></select>
     <button id="reset" onclick="reset()">&nbsp;選択解除</button>
   </div>

    <div id="search-title">
      　<input type ="search" class="search" id="search" onchange="songsearch()" placeholder="曲名を入力">
     　<div style="display: inline-block; _display: inline;" id="radiotitle1"><input type="radio" name="radio" id="radio1" onclick="radiocheck()" checked><span class="strcolor2">曲名順</span></div>
     　<div style="display: inline-block; _display: inline;" id="radiotitle2"><input type="radio" name="radio" id="radio2" onclick="radiocheck()"><span class="strcolor2">歌手順</span></div>
     　<div style="display: inline-block; _display: inline;" id="radiotitle3"><input type="radio" name="radio" id="radio3" onclick="radiocheck()"><span class="strcolor2">配信日順</span></div>
     </div>
  </div>
     <div id="users">
      <table>
       <thead>
        <tr>
         <th class="A0 checkbox"></th>
         <th class="sort A1" data-sort="Ж">曲名</th>
         <th class="sort A2" data-sort="singer">歌手名</th>
         <th class="sort A3" data-sort="date">配信日</th>
         <th class="sort A4">配信タイトル</th>
        </tr>
       </thead>

       <tbody class="list">
  <!--歌枠-->

        <tr class="len sing 夏祭り Whiteberry" id="B1-1-1">
          <td class ="checkbox"><input type="checkbox" onclick="fav();" class="checkbox_check" id="1-1-1"></td>
          <td class="Ж 夏祭り なつまつり">夏祭り</td>
          <td class="singer A2">Whiteberry</td>
          <td class="date A3">2022/8/31</td>
          <td class="title A4"><button class="btn" onclick="window.open('https://youtu.be/dhgjVcXNxuU?t=1h21m45s', 'blank')">【＃たらん祭り】夏祭り先輩と思いっきり楽しむぞ！！【九楽ライ/魔光リサ/神輿たらん】</button></td>
        </tr>


      <!--歌ってみた-->

      <!--<tr class="len エメラルドシティ 西沢さんP" id="B2-1">-->
        <!--<td class ="checkbox"><input type="checkbox" onclick="fav();" class="checkbox_check" id="2-1"></td>-->
        <!--<td class="Ж エメラルドシティ えめらるどしてぃ ">エメラルドシティ</td>-->
        <!--<td class="singer A2">西沢さんP</td>-->
        <!--<td class="date A3">2018/9/29</td>-->
        <!--<td class="title A4"><button class="btn" onclick="window.open('https://youtu.be/w_i0vzngMIo', 'blank')">エメラルドシティ / emerald city - TOKOTOKO(西沢さんP) feat.水瓶ミア【歌ってみた】</button></td>-->
      <!--</tr>-->

      <!--オリ曲-->

      <!--<tr class="len ムーンライト。 水瓶ミア" id="B3-1">-->
        <!--<td class ="checkbox"><input type="checkbox" onclick="fav();" class="checkbox_check" id="3-1"></td>-->
        <!--<td class="Ж ムーンライト。 むーんらいと">ムーンライト。</td>-->
        <!--<td class="singer A2">水瓶ミア</td>-->
        <!--<td class="date A3">2019/4/8</td>-->
        <!--<td class="title A4"><button class="btn" onclick="window.open('https://youtu.be/iN139b5hOT8', 'blank')">ムーンライト。</button></td>-->
      <!--</tr>-->

     </tbody>
    </table>
   </div>
 </div>

 <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
 <script>
  var options = {
    valueNames: ['Ж', 'singer', 'date',]
  };

  var userList = new List('users', options);

 userList.sort('Ж', { order: 'asc' });

 </script>

 <script>

  var songlist = [
    {cd:"non", label:"選択なし", class:"non"},
    {cd:"夏祭り", label:"夏祭り", class:"Whiteberry"},
   ];

 var AmountElements = document.getElementsByClassName("len");
 var AECounts = AmountElements.length;
 var CheckboxElements = document.getElementsByClassName("checkbox_check");
 var CECounts = CheckboxElements.length;
 var SingElements = document.getElementsByClassName("sing");
 var SEcounts = SingElements.length;
 var FavElements;
 var FavLoad;
 var Favid;
 var checkboxA = document.getElementById("checkboxA");
 var checkboxB = document.getElementById("checkboxB");
 var category = document.getElementById("category");
 var category2 = document.getElementById("category-second");
 var SearcBoxElement = document.getElementById("search");

 window.onload = function(){

 //チェックボックス読み込み
 for (var i = 0; i < CECounts; i++){
  FavElements = CheckboxElements[i];
  Favid = FavElements.getAttribute("id");
  FavLoad = JSON.parse(localStorage.getItem(Favid));
  if (FavLoad == true){
   FavElements.checked = true;
  }
 }

 //セレクトボックス表示内容変更
 ChangeSelectboxSong();

 //列調整
  if (window.matchMedia && window.matchMedia('(max-device-width: 480px)').matches) {
   for (var i = 0; i <= AECounts ; i++){
    document.getElementsByClassName('A2')[i].style.display = 'none';
    document.getElementsByClassName('A3')[i].style.display = 'none';
   }
  }
}

//セレクトボックス１動作
function changeCategory() {
  var tagname1;

  for (var i = 0; i < AECounts ; i++){
    tagname1 = AmountElements[i];
    if(category.value == "non"){
      tagname1.style.display = '';
    } else {
      if(tagname1.classList.contains(category.value) == true){
        tagname1.style.display = '';
      } else {
        tagname1.style.display = 'none';
      }
    }
  }
  if (category2.value !== "non" && category2.selectedIndex !== 0){
    category2.selectedIndex = 0;
  }

  if (checkboxA.checked == true){
    favcheck();
  }
  if (checkboxB.checked == true){
    for(i=0; i<SEcounts; i++){
      SingElements[i].style.display = "none";
    }
  }
  ChangeSelectboxSong();
  SearcBoxElement.value = null;
}

//セレクトボックス２動作
function changeCategory2() {
  var tagname2;

  for (var i = 0; i < AECounts ; i++){
    tagname2 = AmountElements[i];
    if (category2.value == "non"){
      if (category.value == "non"){
        tagname2.style.display = "";
      } else {
        changeCategory();
      }
    } else {
      if (tagname2.classList.contains(category2.value) == true){
        tagname2.style.display = "";
      } else {
        tagname2.style.display = "none";
      }
    }
  }
  if (checkboxA.checked == true){
    favcheck();
  }
  if (checkboxB.checked == true){
    for(i=0; i<SEcounts; i++){
      SingElements[i].style.display = "none";
    }
  }
  SearcBoxElement.value = null;
}


//ラジオボタン動作
function radiocheck(){
  if (document.getElementById("radio1").checked == true ){
    userList.sort('Ж', { order: 'asc' });
  } else if (document.getElementById("radio2").checked == true ){
    userList.sort('singer', { order: 'asc' });
  } else if(document.getElementById("radio3").checked == true ){
    userList.sort('date', { order: 'desc' });
  }
}

//選択解除
function reset(){
  category.selectedIndex=0;
  category2.selectedIndex=0;
  ChangeSelectboxSong();
  for (var i=0; i<AECounts; i++){
    AmountElements[i].style.display = "";
  }
  checkboxA.checked = false;
  checkboxB.checked = false;
  SearcBoxElement.value = null;
}

//セレクトボックス２表示内容変更
function ChangeSelectboxSong() {
    category2.textContent = null;

  for(i=0;i<songlist.length;i++){
    var op = document.createElement("option");
    op.value = songlist[i].cd;
    op.text = songlist[i].label;
    if (category.value == "non" ) {
      category2.appendChild(op);
    } else {
      if (i == 0){
        category2.appendChild(op);
      } else{
        if (songlist[i].class == category.value){
          category2.appendChild(op);
        }
      }
    }
  }
}

//動画のみ表示ボタン
function moviedisplay(){
  if (checkboxB.checked == true){
    for(i=0; i<SEcounts; i++){
      SingElements[i].style.display = "none";
    }
  } else if (checkboxB.checked == false){
    if (category2.value == "non" || category2.selectedIndex == 0){
      changeCategory();
    } else {
     changeCategory2();
    }
    if (checkboxA.checked == true){
     favcheck();
    }
  }
}

 //お気に入り動作
function favdisplay(){

 if (checkboxA.checked == true){
  favcheck();
 } else if (checkboxA.checked == false ){
  if (category2.value == "non" || category2.selectedIndex == 0){
    changeCategory();
  } else {
   changeCategory2();
  }
 }
}

//お気に入りチェック
function favcheck(){

 for (var i = 0; i < CECounts; i++){
  FavElements = CheckboxElements[i];
  Favid = FavElements.getAttribute("id");
  FavLoad = JSON.parse(localStorage.getItem(Favid));
  if (FavLoad !== true) {
   document.getElementById("B"+Favid).style.display="none";
  }
 }
}

 //チェックボックス保存
function fav(){
 for (var i = 0; i< CECounts; i++){
  FavElements = CheckboxElements[i];
  Favid = FavElements.getAttribute("id");
  if (FavElements.checked == true){
   localStorage.setItem(Favid, JSON.stringify(true));
  } else {
   localStorage.setItem(Favid, JSON.stringify(false));
  }
 }
}

 //チェックボックス解除
function favremove(){
 var favremoveconfirm = confirm("お気に入り削除しますか");
 if (favremoveconfirm){
   SearcBoxElement.value = null;
   checkboxA.checked = false;
   for (var i = 0; i< CECounts; i++){
     FavElements = CheckboxElements[i];
     Favid = FavElements.getAttribute("id");
     if (FavElements.checked == true){
       FavElements.checked = false;
       localStorage.setItem(Favid, JSON.stringify(false));
     } else {
       localStorage.setItem(Favid, JSON.stringify(false));
     }
   }
   if (category2.value == "non" || category2.selectedIndex == 0){
     changeCategory();
   } else {
     changeCategory2();
   }
  }
}

//曲検索用
function songsearch(){
  var SongsearchElements = document.getElementsByClassName("Ж");
  var SongCounts = SongsearchElements.length;
  var SongSearch;

  category.selectedIndex = 0;
  category2.selectedIndex = 0;

  if(SearcBoxElement.value != "" || SearcBoxElement.value != null){
    for (var i=0; i<AECounts; i++){
       if(SongsearchElements[i].getAttribute("class").indexOf(SearcBoxElement.value) == -1){
         AmountElements[i].style.display = "none";
       } else {
         AmountElements[i].style.display = "";
       }
     }
   } else {
         AmountElements[i].style.display = "";
   }
  checkboxA.checked = false;
  checkboxB.checked = false;
}

 </script>
</body>
</html>
